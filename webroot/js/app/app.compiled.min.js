System.register("config",[],function(){"use strict";var t=!0,e=60,r="js/app/assets/";return{get _DEBUG_MODE_(){return t},get _FPS_(){return e},get _ASSETS_PATH_(){return r}}}),System.register("util",[],function(){"use strict";function t(t){if(s._DEBUG_MODE_){var e=new Date,r=e.getHours(),n=e.getMinutes(),i=e.getSeconds(),o=e.getMilliseconds(),a=r+":"+n+":"+i+":"+o;console.log(a+" "+t)}}function e(t){if(s._DEBUG_MODE_){var e=new Date,r=e.getHours(),n=e.getMinutes(),i=e.getSeconds(),o=e.getMilliseconds(),a=r+":"+n+":"+i+":"+o;$("#debug_board").html(a+" "+t)}}function r(t,e,r,n,i){var s=$("<div>"+t+"</div>"),o={};o[r]=function(){$(this).dialog("close"),i(!1),$(this).dialog("destroy")},o[n]=function(){$(this).dialog("close"),i(!0),$(this).dialog("destroy")},s.dialog({modal:!0,draggable:!0,title:e,height:180,width:500,buttons:o,open:function(){var t=$(".ui-dialog-titlebar-close");t.append('<span class="ui-button-icon-primary ui-icon ui-icon-closethick"></span><span class="ui-button-text">close</span>')},overlay:{opacity:.3,background:"#225b7f"}})}function n(t,e,r,n,i){var s=$("<div>"+t+"</div>"),o={};o[r]=function(){$(this).dialog("close"),i(!1),$(this).dialog("destroy")},o[n]=function(){$(this).dialog("close"),i(!0),$(this).dialog("destroy")},s.dialog({modal:!0,draggable:!0,title:e,width:500,buttons:o,open:function(){var t=$(".ui-dialog-titlebar-close");t.append('<span class="ui-button-icon-primary ui-icon ui-icon-closethick"></span><span class="ui-button-text">close</span>')},overlay:{opacity:.3,background:"#225b7f"}})}function i(t){return t?(t^16*Math.random()>>t/4).toString(16):([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,i)}var s=System.get("config"),o=function(){};return $traceurRuntime.createClass(o,{hoge:function(){console.log("Hoge::hoge")}},{}),{get trace_func(){return t},get debug_board(){return e},get Hoge(){return o},get confirmDialog(){return r},get myDialog(){return n},get uuid(){return i}}}),System.register("objects/debugbox",[],function(){"use strict";var t=System.get("util"),e=(System.get("config"),function(e){t.trace_func("Debugbox::constructor"),this.callback_function=e,this.mesh=new THREE.Mesh(new THREE.BoxGeometry(100,100,100),new THREE.MeshPhongMaterial({color:65280})),this.mesh.castShadow=!0,this.mesh.receiveShadow=!0,this.callback_function(this.mesh)});return $traceurRuntime.createClass(e,{rendering:function(t){this.mesh.rotation.y+=t}},{}),{get Debugbox(){return e}}}),System.register("objects/debugfloor",[],function(){"use strict";var t=System.get("util"),e=(System.get("config"),function(e){t.trace_func("Debugbox::constructor"),this.callback_function=e,this.mesh=new THREE.Mesh(new THREE.PlaneGeometry(1e3,1e3),new THREE.MeshPhongMaterial({color:14737632})),this.mesh.rotation.x=Math.PI+Math.PI/2,this.mesh.receiveShadow=!0,this.callback_function(this.mesh)});return $traceurRuntime.createClass(e,{rendering:function(){}},{}),{get Debugfloor(){return e}}}),System.register("objects/enemies",[],function(){"use strict";var t=System.get("util"),e=System.get("config"),r=function(e,r){t.trace_func("Sprite::constructor"),this.callback_function=r,this.sprite=this.makeTextSprite(e,{fontsize:24,borderColor:{r:255,g:0,b:0,a:1},backgroundColor:{r:255,g:100,b:100,a:.8}}),this.callback_function(this.sprite)};$traceurRuntime.createClass(r,{getSprite:function(){return this.sprite},setPositionVector3:function(t){this.sprite.position.set(t.x,t.y,t.z)},setPosition:function(t,e,r){this.sprite.position.set(t,e,r)},rendering:function(){},makeTextSprite:function(t,e){void 0===e&&(e={});var r=e.hasOwnProperty("fontface")?e.fontface:"Arial",n=e.hasOwnProperty("fontsize")?e.fontsize:18,i=e.hasOwnProperty("borderThickness")?e.borderThickness:4,s=e.hasOwnProperty("borderColor")?e.borderColor:{r:0,g:0,b:0,a:1},o=e.hasOwnProperty("backgroundColor")?e.backgroundColor:{r:255,g:255,b:255,a:1},a=document.createElement("canvas"),c=a.getContext("2d");c.font="Bold "+n+"px "+r;var h=c.measureText(t),u=h.width;c.fillStyle="rgba("+o.r+","+o.g+","+o.b+","+o.a+")",c.strokeStyle="rgba("+s.r+","+s.g+","+s.b+","+s.a+")",c.lineWidth=i,this.roundRect(c,i/2,i/2,u+i,1.4*n+i,6),c.fillStyle="rgba(0, 0, 0, 1.0)",c.fillText(t,i,n+i);var d=new THREE.Texture(a);d.needsUpdate=!0;var l=new THREE.SpriteMaterial({map:d,useScreenCoordinates:!1}),g=new THREE.Sprite(l);return g.scale.set(100,50,1),g},roundRect:function(t,e,r,n,i,s){t.beginPath(),t.moveTo(e+s,r),t.lineTo(e+n-s,r),t.quadraticCurveTo(e+n,r,e+n,r+s),t.lineTo(e+n,r+i-s),t.quadraticCurveTo(e+n,r+i,e+n-s,r+i),t.lineTo(e+s,r+i),t.quadraticCurveTo(e,r+i,e,r+i-s),t.lineTo(e,r+s),t.quadraticCurveTo(e,r,e+s,r),t.closePath(),t.fill(),t.stroke()}},{});var n=function(){this.hp=100,this.mp=0,this.ammo=10,this.status=null,this.character=null,this.target_positions_array=null,this.target_position_index=0,this.current_animation="idol",this.sprite=null};$traceurRuntime.createClass(n,{calcDistance:function(t,e,r,n){var i,s,o;return i=t-r,s=e-n,o=Math.sqrt(Math.pow(i,2)+Math.pow(s,2))},rendering:function(t){var e=new THREE.Vector3(this.target_positions_array[this.target_position_index].x,this.character.root.position.y,this.target_positions_array[this.target_position_index].z);this.character.root.lookAt(e);var r=this.calcDistance(this.character.root.position.x,this.character.root.position.z,e.x,e.z),n=200*t/3;this.character.root.translateZ(n),10>r&&(this.target_position_index+1>=this.target_positions_array.length?this.target_position_index=0:this.target_position_index++),this.sprite.setPosition(this.character.root.position.x,this.character.root.position.y+30,this.character.root.position.z),this.character.update(t)}},{});var i=function(i,s){t.trace_func("Enemies::constructor");var o={baseUrl:e._ASSETS_PATH_+"models/ogro/",body:"ogro-light.js",skins:["grok.jpg","ogrobase.png","arboshak.png","ctf_r.png","ctf_b.png","darkam.png","freedom.png","gib.png","gordogh.png","igdosh.png","khorne.png","nabogro.png"],weapons:[["weapon-light.js","weapon.jpg"]],animations:{move:"run",idle:"stand",jump:"jump",attack:"attack",crouchMove:"cwalk",crouchIdle:"cstand",crouchAttach:"crattack"},walkSpeed:350,crouchSpeed:175},a={moveForward:!1,moveBackward:!1,moveLeft:!1,moveRight:!1};this.callback_function=s,this.characters=new Array,this.cloneCharacterRoots=new Array,this.sprites=new Array;for(var c=0;i>c;c++){var h=new THREE.MD2CharacterComplex;h.scale=1,h.controls=a;var u=new n;u.character=h,u.target_positions_array=new Array;for(var d=0;3>d;d++){var l=Math.floor(1e3*Math.random())-500,g=Math.floor(1e3*Math.random())-500;u.target_positions_array.push({x:l,z:g})}var p=new r("aaa",function(){});u.sprite=p,this.characters.push(u)}var m=new THREE.MD2CharacterComplex;m.scale=3;var f=this;m.onLoadComplete=function(){for(var t=0;i>t;t++){var e=f.characters[t].character;e.shareParts(m),e.enableShadows(!0),e.setWeapon(0),e.setSkin(t),e.frontAcceleration=0,e.controls.moveForward=!0,e.root.position.x=150*t-500,e.root.position.y=25,e.root.position.z=150*t-500,f.cloneCharacterRoots.push(e.root),f.sprites.push(f.characters[t].sprite.getSprite())}f.callback_function(f.cloneCharacterRoots,f.sprites)},m.loadParts(o)};return $traceurRuntime.createClass(i,{rendering:function(t){for(var e=0;e<this.characters.length;e++)this.characters[e].rendering(t)}},{}),{get Enemies(){return i}}}),System.register("objects/shaderbox",[],function(){"use strict";var t=System.get("util"),e=System.get("config"),r=function(r,n,i){t.trace_func("Shaderbox::constructor"),this.callback_function=i;var s=new THREE.ImageUtils.loadTexture(e._ASSETS_PATH_+"cover.png"),o=!0,a=!1,c=!1;o===!0?a=!0:c=!0,this.customUniforms={baseTexture:{type:"t",value:s},time:{type:"f",value:1},grayscale:{type:"i",value:c},sepia:{type:"i",value:a}};var h=new THREE.ShaderMaterial({uniforms:this.customUniforms,vertexShader:r,fragmentShader:n});this.mesh=new THREE.Mesh(new THREE.BoxGeometry(100,100,100),h),this.mesh.castShadow=!0,this.mesh.receiveShadow=!0,this.callback_function(this.mesh)};return $traceurRuntime.createClass(r,{rendering:function(t){this.mesh.rotation.y+=t,this.customUniforms.time.value+=t}},{}),{get Shaderbox(){return r}}}),System.register("testscene",[],function(){"use strict";var t=System.get("util"),e=(System.get("config"),System.get("objects/debugbox")),r=System.get("objects/shaderbox"),n=System.get("objects/debugfloor"),i=System.get("objects/enemies"),s=!0,o=function(e){t.trace_func("TestScene::constructor"),this.renderer,this.scene,this.camera,this.light,this.ambient,this.all_items=4,this.loaded_items=0,this.render_target_array=new Array,this.clock,this.renderer=e,this.scene=new THREE.Scene,this.camera=new THREE.PerspectiveCamera(45,1,.1,1e5),this.camera.position=new THREE.Vector3(0,150,500),this.camera.aspect=window.innerWidth/window.innerHeight,this.camera.updateProjectionMatrix(),this.light=new THREE.SpotLight(16777215),this.light.position.set(100,1e3,0),this.light.angle=Math.PI/4,this.scene.add(this.light),this.ambient=new THREE.AmbientLight(3355443),this.scene.add(this.ambient),this.light.castShadow=!0,this.light.shadowMapWidth=1024,this.light.shadowMapHeight=1024,this.light.shadowCameraNear=100,this.light.shadowCameraFar=1100,this.light.shadowCameraFov=30,this.light.shadowCameraVisible=!0,this.renderer.shadowMapEnabled=!0,this.loadObjects(),s&&(this.trackball=new THREE.TrackballControls(this.camera))};return $traceurRuntime.createClass(o,{getLoadingStatus:function(){return this.all_items===this.loaded_items||0==this.loading?!0:!1},loadedIncrements:function(){this.loaded_items++,this.loaded_items===this.all_items&&(this.loading=!1,this.clock=new THREE.Clock)},rendering:function(){s&&this.trackball.update();for(var t=this.clock.getDelta(),e=0;e<this.render_target_array.length;e++)this.render_target_array[e].rendering(t);this.renderer.render(this.scene,this.camera)},loadObjects:function(){var t=this,s=new e.Debugbox(function(e){e.position.y+=70,t.scene.add(e),t.loadedIncrements()});this.render_target_array.push(s),SHADER_LOADER.load(function(e){var n=e.vertexShader.vertex,i=e.fragmentShader.fragment,s=new r.Shaderbox(n,i,function(e){e.position.y+=70,e.position.x+=120,t.scene.add(e),t.loadedIncrements()});t.render_target_array.push(s)});var o=new n.Debugfloor(function(e){t.scene.add(e),t.loadedIncrements()});this.render_target_array.push(o);var a=new i.Enemies(10,function(e,r){for(var n=0;n<e.length;n++)t.scene.add(e[n]);for(var n=0;n<r.length;n++)t.scene.add(r[n]);t.loadedIncrements()});this.render_target_array.push(a)},resize:function(){t.trace_func("TestScene::resize"),this.camera.aspect=window.innerWidth/window.innerHeight,this.camera.updateProjectionMatrix()}},{}),{get TestScene(){return o}}}),System.register("app",[],function(){"use strict";var t=System.get("util"),e=System.get("config"),r=System.get("testscene"),n=function(){t.trace_func("App::constructor"),this.renderer,this.stats,this.currentSceneObject,this.renderer=Detector.webgl?new THREE.WebGLRenderer({antialias:!0}):new THREE.CanvasRenderer;var n=window.innerWidth,i=window.innerHeight;this.renderer.setSize(n,i),this.renderer.setClearColor(0,1),document.getElementById("canvas").appendChild(this.renderer.domElement),this.stats=new Stats,this.stats.domElement.style.position="absolute",this.stats.domElement.style.top="0px",this.stats.domElement.style.zIndex=100,document.body.appendChild(this.stats.domElement),e._DEBUG_MODE_&&(document.body.appendChild(this.stats.domElement),$(document.body).append('<div id="debug_board" width="200" height="200">test<br>test2<br>test3<br></div')),this.currentSceneObject=new r.TestScene(this.renderer),this.resize()};return $traceurRuntime.createClass(n,{run:function(){t.trace_func("App::run"),this.update()},update:function(){this.rendering(),this.stats.update()},rendering:function(){var t=this;60===e._FPS_?requestAnimationFrame(function(){t.update()}):setTimeout(function(){requestAnimationFrame(function(){t.update()})},1e3/e._FPS_),this.currentSceneObject.getLoadingStatus()===!0&&this.currentSceneObject.rendering()},resize:function(){var e=this;t.trace_func("App::resize"),$(window).resize(function(){var r=window.innerWidth,n=window.innerHeight;t.trace_func("App::resize::resize w:"+r+",h:"+n),e.renderer.setSize(r,n),e.currentSceneObject.resize()})}},{}),$(function(){var t=new n;t.run()}),{}}),System.get("app");